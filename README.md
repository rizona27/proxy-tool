# 代理切换工具说明文档

## 1. 工具概述

代理切换工具是一款基于 PyQt5 开发的 Windows 平台应用程序，旨在提供便捷的代理设置管理功能。用户可以通过简单的界面操作，快速设置或取消系统代理，无需手动修改系统复杂的网络设置。



该工具具有直观的用户界面、智能的 IP 地址输入验证、自动保存设置等功能，适合需要频繁切换代理状态的用户使用。

## 2. 功能特点

- **便捷的代理设置**：通过简单的 IP 地址和端口输入，一键设置系统代理
- **智能 IP 输入**：自定义 IP 输入框支持自动格式化，每 3 位数字自动添加点号，限制输入格式
- **状态实时显示**：底部状态栏实时展示当前代理状态（启用 / 禁用）及代理服务器信息
- **自动保存设置**：自动记录上次使用的代理地址和端口，减少重复输入
- **操作结果反馈**：清晰展示每一步操作的结果，包括成功信息和错误提示
- **管理员权限自动获取**：程序启动时自动检查并获取管理员权限，确保代理设置能正常生效

## 3. 系统要求

- 操作系统：Windows 7/8/10/11
- Python 环境：Python 3.6 及以上（开发 / 源码运行时需要）
- 依赖库：PyQt5（图形界面）

## 4. 安装与运行

### 4.1 源码运行

1. 确保已安装 Python 3.6 及以上版本
2. 安装依赖库：`pip install PyQt5`
3. 下载源码文件
4. 运行命令：`python proxy_tool.py`（假设源码文件名为 proxy_tool.py）

### 4.2 可执行文件运行

对于打包后的可执行文件（.exe），直接双击运行即可，程序会自动请求管理员权限。

## 5. 使用方法

### 5.1 基本操作流程

1. 启动程序，首次运行会请求管理员权限，请允许
2. 在 "代理地址" 输入框中输入代理服务器的 IP 地址（如：192.168.1.1）
3. 在 "代理端口" 输入框中输入代理服务器的端口号（如：8080）
4. 点击 "设置代理" 按钮启用代理
5. 需要关闭代理时，点击 "取消代理" 按钮

### 5.2 界面元素说明

- **代理地址输入框**：用于输入代理服务器的 IP 地址，支持自动格式化
- **代理端口输入框**：用于输入代理服务器的端口号，仅允许数字输入
- **设置代理按钮**：应用并启用代理设置
- **取消代理按钮**：禁用当前代理设置
- **操作结果区域**：显示最近一次操作的结果信息
- **状态栏**：显示当前代理状态和代理服务器信息
- **ReadMe 链接**：点击可查看工具说明和联系信息

## 6. 技术实现细节

### 6.1 核心功能模块

- **IPLineEdit 类**：自定义 IP 地址输入框，实现 IP 地址的自动格式化和验证

- **ProxyTool 类**：主窗口类，实现界面布局和核心功能逻辑

- 代理设置管理

  ：通过操作 Windows 注册表实现代理设置的修改

  - 注册表路径：`HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings`
  - 关键注册表项：ProxyEnable（代理开关）和 ProxyServer（代理服务器信息）

### 6.2 关键技术点

- **权限管理**：使用 ctypes 库检查和获取管理员权限，确保能修改系统设置
- **注册表操作**：通过 winreg 模块读写系统注册表，实现代理设置
- **系统刷新**：修改注册表后，通过调用 Windows API 刷新系统设置，使代理变更立即生效
- **设置持久化**：使用 QSettings 保存用户输入的代理信息，实现记忆功能
- **界面美化**：通过自定义样式表实现现代化的 UI 设计

## 7. 常见问题

### 7.1 为什么需要管理员权限？

修改系统代理设置需要相应的系统权限，因此程序需要以管理员身份运行才能正常工作。

### 7.2 代理设置不生效怎么办？

1. 确保输入的 IP 地址和端口号正确无误
2. 尝试重新启动程序并再次设置
3. 检查网络连接和代理服务器是否正常工作

------



**文档版本**：1.0
**最后更新**：2025 年 7 月